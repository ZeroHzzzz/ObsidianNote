这里有一个重要的概念需要区分：[[桥接]]和[[路由]]。

- **桥接**工作在数据链路层（Layer 2），它只根据 MAC 地址来转发数据包，不关心 IP 地址。它把两个网络段**合并**成一个，所以它们共享同一个 IP 地址段，比如 `192.168.1.x`。
- **路由**工作在[[网络层]]（Layer 3），它根据 IP 地址来转发数据包。它连接的是两个**不同的**网络段，比如 `192.168.1.x` 和 `192.168.2.x`。路由器的作用就是在这些不同的网络之间找到最佳路径。

所以，如果你的目标是让两个独立的局域网**共享同一个地址段**，互相透明通信，那就需要**桥接**。如果两个局域网使用**不同的地址段**，并且你需要它们能相互访问，那就需要**路由**。

## 桥接

这里有一个问题，桥接前和桥接后局域网ip是如何变化的？

首先我们要来模拟一下下。

### 桥接前的局域网

在进行桥接前，你有两个**独立的局域网**。假设它们是：

- **局域网 A**: 它的 IP 地址段可能是 `192.168.1.x`，连接着电脑 A、服务器 A 等设备。
- **局域网 B**: 它的 IP 地址段可能是 `192.168.2.x`，连接着电脑 B、服务器 B 等设备。

在这种情况下，局域网 A 的设备**无法直接访问**局域网 B 的设备，反之亦然。因为它们处于不同的IP地址段，需要一个**路由器**来处理跨网段的流量转发。

### 桥接后的局域网

当你将这两个局域网**桥接**起来后，它们的 IP 地址会发生一个根本性的变化：它们会**合并**成一个大的局域网，IP段是会变的。

- **IP地址段**：**两个局域网将使用同一个IP地址段**，比如 `192.168.1.x`。
- **IP地址分配**：为了避免IP地址冲突，你需要确保所有设备都从同一个DHCP服务器（通常是主路由器）获取IP地址，或者手动为它们分配同一网段的静态IP。
- **设备通信**：桥接后，局域网 A 的设备（例如电脑 A，IP是 `192.168.1.10`）可以**直接访问**局域网 B 的设备（例如电脑 B，IP是 `192.168.1.20`），就像它们连接在同一个交换机上一样。它们之间的通信不再需要路由器来转发，而是通过桥接设备（例如你配置的电脑或交换机）在数据链路层（Layer 2）直接进行。

## 路由

如果我想让他们IP段不变，还是用原来的地址，那我们就需要用到路由的方法。

这个过程通常需要一个**路由器**或一台配置了路由功能的电脑。

1. **连接两个网络**: 你需要一台拥有两张网卡的设备（路由器或电脑），其中一张网卡连接到 `192.168.1.x` 网段，另一张连接到 `192.168.2.x` 网段。
2. **配置IP地址**:
    - 连接 `192.168.1.x` 网段的网卡需要配置一个该网段的IP地址，比如 `192.168.1.1`。
    - 连接 `192.168.2.x` 网段的网卡需要配置一个该网段的IP地址，比如 `192.168.2.1`。
3. **设置路由规则**:
    - 在 `192.168.1.x` 网段的设备上，你需要告诉它：如果要访问 `192.168.2.x` 网段，数据包应该发送给 `192.168.1.1` 这个“网关”。
    - 反之，在 `192.168.2.x` 网段的设备上，你需要告诉它：如果要访问 `192.168.1.x` 网段，数据包应该发送给 `192.168.2.1` 这个“网关”。

当 `192.168.1.x` 网段的设备想要访问 `192.168.2.x` 网段的设备时，它会把数据包发送给网关 (`192.168.1.1`)。路由器接收到数据包后，会根据目的IP地址（例如 `192.168.2.100`），将数据包从 `192.168.2.1` 的网卡转发出去，最终到达目标设备。
