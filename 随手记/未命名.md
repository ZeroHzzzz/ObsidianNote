在 IntelliJ IDEA 上实现解析上传的成绩文件并导出为 Excel 的完整教程如下。我们将使用 Java 的 Servlet 进行文件上传和解析，并使用 Apache POI 库来处理 Excel 文件的生成。接下来是详细步骤：

### 1. 安装 IntelliJ IDEA 和 Java SDK

确保你已经安装了 IntelliJ IDEA 和 Java SDK。建议使用最新的 JDK 版本（例如 JDK 11 或 JDK 17）。

### 2. 创建一个 Maven 项目

在 IntelliJ IDEA 中，创建一个新的 Maven 项目，这将自动为你管理项目的依赖关系。

**步骤：**

-   打开 IntelliJ IDEA。
-   点击 `File -> New -> Project`。
-   选择 `Maven`，并设置 `GroupId`（例如 `com.example`）和 `ArtifactId`（例如 `StudentScoreApp`）。
-   点击 `Finish` 创建项目。

### 3. 添加 Maven 依赖

为了使用 Apache POI 库来生成 Excel 文件，你需要在 `pom.xml` 中添加 POI 依赖：

```xml
<dependencies>
    <!-- Servlet API -->
    <dependency>
        <groupId>javax.servlet</groupId>
        <artifactId>javax.servlet-api</artifactId>
        <version>4.0.1</version>
        <scope>provided</scope>
    </dependency>

    <!-- Apache POI for Excel generation -->
    <dependency>
        <groupId>org.apache.poi</groupId>
        <artifactId>poi-ooxml</artifactId>
        <version>5.2.2</version>
    </dependency>

    <!-- Apache Commons FileUpload for file upload handling -->
    <dependency>
        <groupId>commons-fileupload</groupId>
        <artifactId>commons-fileupload</artifactId>
        <version>1.4</version>
    </dependency>

    <!-- Apache Commons IO -->
    <dependency>
        <groupId>commons-io</groupId>
        <artifactId>commons-io</artifactId>
        <version>2.11.0</version>
    </dependency>
</dependencies>
```

### 4. 配置 web.xml 文件

创建一个 `WEB-INF` 目录，并在其中添加 `web.xml` 文件，用于配置你的 Servlet：

```xml
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns="http://java.sun.com/xml/ns/javaee"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
         version="3.0">
    <servlet>
        <servlet-name>ParseJsonServlet</servlet-name>
        <servlet-class>com.example.ParseJsonServlet</servlet-class>
    </servlet>
    <servlet-mapping>
        <servlet-name>ParseJsonServlet</servlet-name>
        <url-pattern>/parsejson.do</url-pattern>
    </servlet-mapping>

    <servlet>
        <servlet-name>ExportExcelServlet</servlet-name>
        <servlet-class>com.example.ExportExcelServlet</servlet-class>
    </servlet>
    <servlet-mapping>
        <servlet-name>ExportExcelServlet</servlet-name>
        <url-pattern>/exportExcel.do</url-pattern>
    </servlet-mapping>
</web-app>
```

### 5. 创建文件上传表单 (`uploadfile.html`)

在 `WebContent` 目录下创建 `uploadfile.html` 文件，用于上传学生成绩文件。

```html
<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Upload Java Scores</title>
    </head>
    <body>
        <h2>Upload Student Scores</h2>
        <form action="parsejson.do" method="post" enctype="multipart/form-data">
            <label for="file">Choose file:</label>
            <input type="file" id="file" name="file" />
            <input type="submit" value="Upload and Parse" />
        </form>
    </body>
</html>
```

### 6. 实现 `ParseJsonServlet` 类

此类负责解析上传的成绩文件，并将解析后的结果显示在网页上。

```java
package com.example;

import javax.servlet.ServletException;
import javax.servlet.annotation.MultipartConfig;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.*;
import java.io.*;
import java.util.ArrayList;
import java.util.List;

@WebServlet("/parsejson.do")
@MultipartConfig
public class ParseJsonServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        response.setContentType("text/html;charset=UTF-8");
        PrintWriter out = response.getWriter();

        Part filePart = request.getPart("file");
        InputStream fileContent = filePart.getInputStream();
        BufferedReader reader = new BufferedReader(new InputStreamReader(fileContent));

        List<String[]> studentData = new ArrayList<>();
        String line;
        while ((line = reader.readLine()) != null) {
            if (!line.trim().isEmpty()) {
                String[] data = line.trim().split("\\s+");
                studentData.add(new String[]{data[2], data[0], data[3], data[1]});
            }
        }

        request.getSession().setAttribute("studentData", studentData);

        out.println("<html><body>");
        out.println("<h2>学生成绩列表</h2>");
        out.println("<table border='1'><tr><th>序号</th><th>学号</th><th>姓名</th><th>课程名称</th><th>成绩</th></tr>");
        int count = 1;
        for (String[] student : studentData) {
            out.println("<tr><td>" + (count++) + "</td><td>" + student[0] + "</td><td>" + student[1] + "</td><td>" + student[2] + "</td><td>" + student[3] + "</td></tr>");
        }
        out.println("</table>");
        out.println("<br><a href='exportExcel.do'>导出excel</a>");
        out.println("</body></html>");
    }
}
```

### 7. 实现 `ExportExcelServlet` 类

此类负责将解析的成绩导出为 Excel 文件。

```java
package com.example;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.*;
import org.apache.poi.ss.usermodel.*;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import java.io.*;
import java.util.List;

@WebServlet("/exportExcel.do")
public class ExportExcelServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        response.setContentType("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet");
        response.setHeader("Content-Disposition", "attachment; filename=studentscores.xlsx");

        Workbook workbook = new XSSFWorkbook();
        Sheet sheet = workbook.createSheet("Student Scores");

        // Create header row
        Row header = sheet.createRow(0);
        header.createCell(0).setCellValue("序号");
        header.createCell(1).setCellValue("学号");
        header.createCell(2).setCellValue("姓名");
        header.createCell(3).setCellValue("课程名称");
        header.createCell(4).setCellValue("成绩");

        // Get student data from session
        List<String[]> studentData = (List<String[]>) request.getSession().getAttribute("studentData");

        // Write student data to Excel
        int rowNum = 1;
        for (int i = 0; i < studentData.size(); i++) {
            Row row = sheet.createRow(rowNum++);
            row.createCell(0).setCellValue(i + 1);
            row.createCell(1).setCellValue(studentData.get(i)[0]);  // 学号
            row.createCell(2).setCellValue(studentData.get(i)[1]);  // 姓名
            row.createCell(3).setCellValue(studentData.get(i)[2]);  // 课程名称
            row.createCell(4).setCellValue(studentData.get(i)[3]);  // 成绩
        }

        // Write the Excel file to response output stream
        OutputStream out = response.getOutputStream();
        workbook.write(out);
        workbook.close();
    }
}
```

### 8. 部署项目

-   确保你已经在项目中添加了 Servlet API 和 Apache POI 的依赖。
-   在 `WEB-INF` 文件夹中创建 `web.xml` 并配置 Servlet。
-   右键点击项目，选择 `Run` 来启动项目。

### 9. 测试应用程序

1. 启动你的 Maven 项目。
2. 打开浏览器，访问表单页面，例如 `http://localhost:8080/uploadfile.html`。
3. 上传文件（例如 `javascore.txt`），点击 `上传并解析`。
4. 页面会显示解析后的学生成绩表格，并在底部显示导出 Excel 的链接。
5. 点击 `导出excel`，成绩会下载为 Excel 文件。

这样，你已经成功实现了一个能够解析文件并导出 Excel 的 web 应用。
