在开始之前我们需要搞懂几个问题，什么是授权，什么是认证，什么的是鉴权，什么是权限控制。

# 这些都是什么玩意

## 认证——“"是你吗？"”

认证关注**真实性验证**，可能不直接与身份相关。计算机中认证这个东西非常常见，一如验证数字签名或公钥证书，HTTPS 的 TLS 握手等等。

和鉴权不同的是，认证关心的是你可不可信，而鉴权关心的是你合不合法

## 授权——”你可以做什么？“

字面意思。
授权就是指根据用户的身份和权限授予或拒绝其访问特定资源的操作，也就是决定“你可以做什么”

## 鉴权——“你是谁？”

鉴权是验证用户身份的过程，其目的是确定请求来自谁。换句话说，是确认“你是谁”的过程。

鉴权的方式有很多种，下面我会进行一个总结。

## 权限控制——"谁能做什么"

权限控制是对系统中资源访问进行管理和限制的机制，是一个包含鉴权和授权的整体过程。他的范围更广，不仅仅是对用户，还包括对设备、进程、应用的访问管理，既可以在操作系统层实现（文件系统权限），也可以在应用层实现（API权限管理）

## 举例？

假设你在使用一个云存储服务（如Google Drive）：

-   鉴权：你输入邮箱和密码，Google通过密码确认你是合法用户。

-   认证：Google会检查你的设备是否安全，例如验证是否来自可信浏览器，或者是否启用了两步验证。

-   授权：如果你是文件的创建者，你有“读写”权限。 如果你是被分享者，可能只拥有“只读”权限。

-   权限控制：如果你的权限是“只读”，则系统会阻止你修改文件。管理员可以设置文件夹的访问规则，限制分享行为。

---

搞清楚了这几个问题，下面就可以来看我们常用的鉴权方案了。

# HTTP 基本鉴权 (Basic auth)

HTTP 基本鉴权（Basic Authentication）是一种简单的身份验证机制，在 HTTP 请求头中传递用户名和密码。客户端将用户名和密码以“用户名:密码”的形式拼接，然后进行 Base64 编码，并将结果放在请求头的 `Authorization` 字段中，如：

```header
Authorization: Basic dXNlcm5hbWU6cGFzc3dvcmQ=
```

其中，`dXNlcm5hbWU6cGFzc3dvcmQ=` 是 `username:password` 字符串经过 Base64 编码后的结果。虽然实现简单，但由于用户名和密码直接暴露，基本鉴权不够安全，因此基本上都不会使用，这里了解就可以了。

HTTPS 会让这个方法变得安全。

# Session-Cookie 鉴权

很常用的鉴权方式，很多网站都爱用。他是利用服务端的 Session（会话）和 浏览器（客户端） 的 Cookie 来实现的。首先我们要搞清楚一些基本的概念。

## 什么是Cookie

**Cookie** 是一种由网站存储在用户设备上的小型文本文件，用于存储关于用户的信息，通常包含一些会话信息或偏好设置。由于他储存的基本都是小块的数据，因此被刚开始的人们命名为饼干（

## 什么是Session

**Session**就是会话，就是指用户与服务器之间的一段交互过程，通常从用户访问服务器开始，到用户离开或会话超时结束。由于HTTP是无状态的，为了在多次请求中保持用户的状态，服务器会为用户创建一个 **Session**，用来保存与该用户相关的数据。

相比于 Cookie，Session 数据存储在服务器端，而客户端通过浏览器存储一个与 Session 关联的标识符（如 **Session ID**），用于与服务器对应的会话数据建立关联。

**也就是说，Session 是基于 Cookie 的**

## 基本流程

![看来看去这个流程图比较好](https://cloud.intro-iu.top:738/d/ThreeBody/ZeroHzzzzPic/202412061220426.png)

## Session-Cookie 鉴权的关键点

-   **Session ID 的有效性**：Session ID 必须在服务器端有效，才能验证用户身份。如果 Session 被删除或过期，用户将需要重新登录。
-   **Session 的过期时间**：服务器会为每个 Session 设置一个过期时间，用户在会话期间如果没有活动，则 Session 会自动失效。
-   **Cookie 的安全性**：为了防止被窃取，建议使用 `HttpOnly` 和 `Secure` 属性来保护 Session ID。
    -   **HttpOnly** 防止 JavaScript 访问 Cookie。
    -   **Secure** 保证 Cookie 只通过 HTTPS 传输。

# Token 鉴权

前面可以知道，Session-Cookie鉴权方案有个缺点就是服务端需要维护用户的Sessionid，当我们需要水平拓展的时候，可能就需要起一个Redis来保持会话的一致性。我们就在考虑能不能让服务端不用去维护状态，让用户的访问的时候我们能获取到他的状态即可，因此就有了Token这种鉴权方式。

Token是一类鉴权方案，而不是单独一种。比如我们熟知的JWT、OAuth2.0 Token这些他都属于Token鉴权方案。这一节中我们了解他Token鉴权的一些共性和一些基础的知识即可。

## 什么是Token

Token就是令牌。字面意思。客户端访问服务器时，验证通过后服务端会为其签发一张令牌，之后，客户端就可以携带令牌访问服务器，服务端只需要验证令牌的有效性即可。

和Session-Cookie差不多，由于你收到Token之后后续需要一直使用，因此客户端需要把他存起来，对于Web端而言一般就存在Cookie里面，但是Token鉴权向服务端发Token一般是放在HTTP 请求头 Authorization 字段。这个是因为 Cookie 是不允许跨域访问的，而且容易受到到 CSRF 攻击

## 基本流程

![image.png|650](https://cloud.intro-iu.top:738/d/ThreeBody/ZeroHzzzzPic/202412061231343.png)
