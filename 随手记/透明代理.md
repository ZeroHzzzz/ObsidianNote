**透明[[代理]]**（Transparent Proxy），顾名思义，就是对用户而言“透明”的代理服务器。它工作在[[网络层]]，对用户的设备和应用程序来说是完全不可见的。当你通过一个透明代理上网时，你甚至不会意识到自己的流量正在经过一个代理服务器。

和普通代理的区别就是对用户不可见。

我们以v2rayA为例讲解一下几种透明代理的实现方式。

## Redir-TCP/UDP (NAT 模式)

这个模式实际上就是 **NAT 透明代理**，它使用 `iptables` 的 `REDIRECT` 规则来实现。

其原理就是，当你的设备流量到达路由器或网关时，`REDIRECT` 规则会修改数据包的目的地址和端口，让它看起来是发往本地 v2rayA 代理的。这种配置最简单，对大多数设备都非常友好，因为它不依赖于任何复杂的内核功能，兼容性强，对代理程序和系统要求都低。

但是他的缺点就是，他会丢失源[[IP]]，代理服务器**无法看到原始设备的 IP 地址**，它看到的源 IP 永远是路由器的 IP。这导致你无法在 v2rayA 的日志中准确追踪是哪个设备或哪个客户端发出的请求。并且这种方式对协议支持有限，主要针对 TCP 和 UDP 协议。

## TProxy-TCP/UDP (TProxy 模式)

其原理是它利用 Linux 内核的 `TPROXY` 功能，直接拦截流量并将其交给 v2rayA，而**不修改数据包的任何地址**。v2rayA 代理接收到的是原始的、未被篡改的数据包。

相比上一种方法，他的优点就在于代理服务器能直接看到请求的**原始设备 IP**，这对于流量分析、日志审计和精细化的访问控制非常有帮助。由于数据包地址没有被修改，这种方式更加“透明”和纯粹。

但是相应的底层要求更高，需要确保你的系统内核和路由配置支持 TProxy。
