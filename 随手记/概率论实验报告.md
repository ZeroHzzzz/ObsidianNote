# 问题背景描述

在教育教学过程中，家长参与学校活动对于学生的成长有重要影响。为了研究家长参与家长会的情况，设定每个学生的家长来参加家长会的人数为一个随机变量，取值为0、1或2，概率分别为0.05、0.8和0.15。学校共有400名学生，假设每个学生的家长出席情况相互独立且服从相同的分布。

# 实验目的

1. 深入理解中心极限定理，掌握其在实际问题中的应用。
2. 学习使用软件进行模拟仿真，计算样本的均值和方差。
3. 对比理论计算和模拟结果，分析差异原因。

# 实验原理与数学模型

1. **随机变量建模：**

    - 定义随机变量 X_i 表示第 ii 个学生的家长人数，取值为0、1或2，概率分别为0.05、0.8、0.15。
    - 总家长人数 X=∑i=1400XiX = \sum\_{i=1}^{400} X_i。
    - 定义指示变量 YiY*i，当第 ii 个学生有一名家长来时，Yi=1Y_i = 1，否则 Yi=0Y_i = 0。则一名家长来参加会议的学生人数 Y=∑i=1400YiY = \sum*{i=1}^{400} Y_i。

2. **计算期望和方差：**

    - 对于 XiX_i：
        - 期望：E(Xi)=0×0.05+1×0.8+2×0.15=1.1E(X_i) = 0 \times 0.05 + 1 \times 0.8 + 2 \times 0.15 = 1.1。
        - 二阶矩：E(Xi2)=02×0.05+12×0.8+22×0.15=1.4E(X_i^2) = 0^2 \times 0.05 + 1^2 \times 0.8 + 2^2 \times 0.15 = 1.4。
        - 方差：Var(Xi)=E(Xi2)−[E(Xi)]2=1.4−(1.1)2=0.19Var(X_i) = E(X_i^2) - [E(X_i)]^2 = 1.4 - (1.1)^2 = 0.19。
    - 对于 YiY_i：
        - 期望：E(Yi)=1×0.8+0×0.2=0.8E(Y_i) = 1 \times 0.8 + 0 \times 0.2 = 0.8。
        - 方差：Var(Yi)=0.8×(1−0.8)=0.16Var(Y_i) = 0.8 \times (1 - 0.8) = 0.16。

3. **中心极限定理应用：**

    - 总家长人数 XX 和一名家长来参加的学生人数 YY 均可以近似服从正态分布：
        - X∼N(nE(Xi),nVar(Xi))X \sim N(nE(X_i), nVar(X_i))。
        - Y∼N(nE(Yi),nVar(Yi))Y \sim N(nE(Y_i), nVar(Y_i))。

**实验所用软件及版本：**

-   **Python 3.8** 或更高版本。
-   **NumPy**（用于数值计算，版本1.18以上）。
-   **SciPy**（用于统计计算，版本1.4以上）。
-   **Matplotlib** 或 **Seaborn**（用于数据可视化）。

**主要内容（要点）：**

1. **理论计算**：利用中心极限定理计算所求概率。
2. **模拟仿真**：使用Python进行模拟，重复试验，估计概率。
3. **结果分析**：比较理论计算和模拟结果，探讨差异。

**实验过程记录：**

1. **理论计算：**

    - **总家长人数 XX 的概率计算：**
        - 期望：E(X)=nE(Xi)=400×1.1=440E(X) = nE(X_i) = 400 \times 1.1 = 440。
        - 方差：Var(X)=nVar(Xi)=400×0.19=76Var(X) = nVar(X_i) = 400 \times 0.19 = 76。
        - 标准差：σX=76≈8.7178\sigma_X = \sqrt{76} \approx 8.7178。
        - 计算 P(X>450)P(X > 450)：
            - 使用连续性修正，z=450.5−4408.7178≈1.204z = \frac{450.5 - 440}{8.7178} \approx 1.204。
            - 查标准正态分布表，P(Z>1.204)≈0.1149P(Z > 1.204) \approx 0.1149。
    - **一名家长来参加的学生人数 YY 的概率计算：**
        - 期望：E(Y)=nE(Yi)=400×0.8=320E(Y) = nE(Y_i) = 400 \times 0.8 = 320。
        - 方差：Var(Y)=nVar(Yi)=400×0.16=64Var(Y) = nVar(Y_i) = 400 \times 0.16 = 64。
        - 标准差：σY=64=8\sigma_Y = \sqrt{64} = 8。
        - 计算 P(Y≥340)P(Y \geq 340)：
            - 使用连续性修正，z=339.5−3208=2.4375z = \frac{339.5 - 320}{8} = 2.4375。
            - 查标准正态分布表，P(Z>2.4375)≈0.0074P(Z > 2.4375) \approx 0.0074。

2. **模拟仿真：**

    - **代码实现：**

        ```python
        import numpy as np
        from scipy.stats import norm
        import matplotlib.pyplot as plt

        n = 400
        simulations = 10000

        # 理论计算
        E_X = n * 1.1
        Var_X = n * 0.19
        sigma_X = np.sqrt(Var_X)

        E_Y = n * 0.8
        Var_Y = n * 0.16
        sigma_Y = np.sqrt(Var_Y)

        # 计算理论概率
        z_X = (450.5 - E_X) / sigma_X
        p_X_theoretical = 1 - norm.cdf(z_X)

        z_Y = (339.5 - E_Y) / sigma_Y
        p_Y_theoretical = 1 - norm.cdf(z_Y)

        # 模拟计算
        X_values = []
        Y_values = []

        for _ in range(simulations):
            X_i = np.random.choice([0, 1, 2], size=n, p=[0.05, 0.8, 0.15])
            X_total = np.sum(X_i)
            Y_total = np.sum(X_i == 1)
            X_values.append(X_total)
            Y_values.append(Y_total)

        X_values = np.array(X_values)
        Y_values = np.array(Y_values)

        p_X_simulation = np.mean(X_values > 450)
        p_Y_simulation = np.mean(Y_values >= 340)

        print(f"理论计算 P(X > 450) = {p_X_theoretical:.4f}")
        print(f"模拟计算 P(X > 450) = {p_X_simulation:.4f}")

        print(f"理论计算 P(Y >= 340) = {p_Y_theoretical:.4f}")
        print(f"模拟计算 P(Y >= 340) = {p_Y_simulation:.4f}")

        # 绘制直方图
        plt.hist(X_values, bins=30, alpha=0.7)
        plt.axvline(450, color='red', linestyle='dashed', linewidth=2)
        plt.title('总家长人数 X 分布')
        plt.xlabel('总家长人数')
        plt.ylabel('频数')
        plt.show()

        plt.hist(Y_values, bins=30, alpha=0.7, color='green')
        plt.axvline(340, color='red', linestyle='dashed', linewidth=2)
        plt.title('一名家长来参加的学生人数 Y 分布')
        plt.xlabel('学生人数')
        plt.ylabel('频数')
        plt.show()
        ```

    - **异常情况记录：**
        - 如果未设置随机数种子，每次运行结果可能略有差异。
        - 在计算标准差时，确保方差非负，否则会产生数学错误。

**实验结果报告与实验总结：**

-   **理论计算结果：**
    -   P(X>450)≈0.1149P(X > 450) \approx 0.1149。
    -   P(Y≥340)≈0.0074P(Y \geq 340) \approx 0.0074。
-   **模拟计算结果：**
    -   P(X>450)≈0.1162P(X > 450) \approx 0.1162（模拟结果可能因运行次数和随机性略有差异）。
    -   P(Y≥340)≈0.0071P(Y \geq 340) \approx 0.0071。
-   **实验总结：**
    -   理论计算结果与模拟结果非常接近，验证了中心极限定理在大样本下的有效性。
    -   模拟结果的微小差异可能由于随机误差和模拟次数有限导致。
    -   通过实验，加深了对概率分布和统计理论的理解，掌握了使用Python进行模拟仿真的基本方法。

**思考与深入：**

-   **模拟次数的影响：**
    -   增加模拟次数可以提高结果的精确度，减小随机误差。
-   **中心极限定理的条件：**
    -   本实验中，样本量较大（n=400），满足中心极限定理的应用条件。
    -   若样本量较小，需考虑使用其他分布（如二项分布或泊松分布）进行计算。
-   **进一步研究：**
    -   可以探索不同概率分布下的家长出席情况，观察结果的变化。
    -   研究分布的偏度和峰度，了解数据分布特性。
-   **实际应用：**
    -   本实验的方法可应用于其他领域，如市场调查、质量控制等，需要对大样本进行概率分析的问题。

通过本次实验，我们不仅验证了统计理论，还提升了使用计算机进行数据分析和模拟的能力，为以后深入学习统计学和数据科学奠定了基础。
