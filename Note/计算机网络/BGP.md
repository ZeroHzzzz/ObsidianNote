## 什么是自治系统

互联网是一个由网络组成的网络。它由成千上万个被称为“自治系统”（autonomous system，AS）的更小网络组成。这些网络中的每一个实际上就是由单一组织运行的一个大型路由器池。

## 什么是 BGP

边界网关协议 (BGP) 就是互联网的邮政服务。当有人把一封信投进邮筒时，邮政服务就会处理这封邮件，并选择一条快速、高效的路线将这封信投递给收件人。同样地，当有人通过互联网提交数据时，BGP 负责寻找数据能传播的所有可用路径，并选择最佳的路由，这通常意味着在自治系统之间跳跃。

自治系统一般属于互联网服务提供商（ISP）或其他大型组织，例如科技公司、高校、政府机构和科研机构。每个希望交换**路由**信息的 AS 都必须具有一个注册的自治系统编号（**ASN**）。互联网号码分配机构（IANA）向地区互联网注册机构（RIR）分配 ASN，后者再将其分配给 ISP 和网络。ASN 是介于 1 到 65534 之间的 16 位数字，以及介于 131072 和 4294967294 之间的 32 位数字。截至 2018 年，全世界使用中的 ASN 共有大约 6.4 万个。**只有外部 BGP 才需要 ASN**。

## 外部 BGP 与内部 BGP 有什么区别

在互联网上，路由交换和流量传输是通过外部 BGP（eBGP）进行的。自治系统也可使用 BGP 的内部版本来路由内部网络上的数据，也就是 iBGP。应该指出的是，使用内部 BGP 并非使用外部 BGP 的前提条件。自治系统可从多种内部协议中选择，来连接内部网络上的路由器。

外部 BGP 就像国际运输。在国际上运送邮件时，需要遵循特定的标准和规则。邮件到达目的地国家后，必须通过目的地国家的本地邮政服务才能达到其最终目的地。每个国家都有自己的内部邮政服务，不必遵循其他国家的相同规则。同样，每个自治系统都可以有自己的内部路由协议，用于路由自身网络内部的数据

## BGP属性

BGP试图为网络流量找到最有效的路径。 但如上所述，跳数并不是BGP路由器寻找这些路径的唯一因素。 BGP为每条路径分配属性，这些属性有助于路由器在有多个选项时选择路径。 许多路由器允许管理员自定义属性，以便更精细地控制网络上的流量流动方式。 BGP属性的一些例子是：

-   重量：一个思科专有的属性，它告诉路由器哪些本地路径是首选。
-   本地偏爱：这告诉路由器要选择哪条出站路径。
-   Originate：这告诉路由器选择它自己添加到BGP的路由。
-   AS路径长度：这个属性告诉路由器更倾向于短路径

## BGP劫持

-   通过将用户重新引导到虚假网站进行网络钓鱼和社会工程
-   拒绝服务（DoS） ，通过流量 黑客攻击 或重定向。
-   路径上的攻击 ，以修改交换的数据，并颠覆基于信誉的过滤系统
-   冒名攻击以窃听通信

## 保证BGP的安全

2008 年推出的资源公钥基础设施（RPKI）的路由安全框架。RPKI 使用被称为**路由源授权（Route Origin Authorization, ROA）** 的加密签名记录，以验证哪个网络运营商允许使用 BGP 来公告某个组织的 IP 地址。这确保了获授权方才能公告某个组织的前缀。
